digraph {
    rankdir=TB;
    node [shape=box, style=rounded];
    edge [fontsize=10];

    __start__ [shape=point, width=0.2];
    __start__ -> IDLE;


    IDLE -> VALIDATING_CHECKPOINT [label="LOCK_INTENT"];
    VALIDATING_CHECKPOINT -> SELECTING_WITNESSES [label="auto\n[CHAIN_CONTAINS_HASH (my_c...]"];
    SENDING_REJECTION -> IDLE [label="auto"];
    SELECTING_WITNESSES -> SENDING_COMMITMENT [label="auto"];
    SENDING_COMMITMENT -> WAITING_FOR_LOCK [label="auto"];
    WAITING_FOR_LOCK -> SERVICE_PHASE [label="BALANCE_UPDATE_BROADCAST\n[message.lock_result.sessi...]"];
    WAITING_FOR_LOCK -> IDLE [label="timeout(LOCK_TIMEOUT)"];
}