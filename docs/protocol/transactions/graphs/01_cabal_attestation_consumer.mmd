stateDiagram-v2
    [*] --> WAITING_FOR_VM
    SESSION_ENDED --> [*]
    WAITING_FOR_VM --> WAITING_FOR_VM : setup_session
    WAITING_FOR_VM --> CONNECTING : VM_READY
    CONNECTING --> CONNECTED : [auto]
    CONNECTED --> SESSION_ENDED : SESSION_TERMINATED
    CONNECTED --> CONNECTED : ATTESTATION_RESULT
    CONNECTED --> REQUESTING_CANCEL : request_cancel
    REQUESTING_CANCEL --> CONNECTED : [auto]
    SESSION_ENDED --> SESSION_ENDED : ATTESTATION_RESULT